# 渲染知识笔记    

## SSAO（屏幕空间环境光遮蔽）   
### 基本定义 
Ambient Occlusion: 通过场景中的某个点来产生一个标量值，用来表示从该点向各个方向发出的射线被遮挡的概率。该标量值用来产生全局的遮挡效果，为用户提供关于场景中物体位置关系和表面起伏情况的视觉信息。AO的计算通过半球面上可见性积分得到，具体计算方式：[AO计算原理](https://zhuanlan.zhihu.com/p/46633896)  
SSAO是一种基于屏幕空间的AO算法   
### SSAO算法  
AO的半球积分计算复杂度高，一般应用于离线渲染，在实时渲染中需要计算效率更高的算法，而SSAO是实时渲染中常用的算法。使用当前视点的深度缓存当成场景中物体遮挡关系的粗略近似代替光线来求AO。
### SSAO特点    
- 与场景复杂度不相关，与场景中的顶点数和三角形没有关系，仅和投影后的像素有关   
- 相比于传统AO，无需预处理，无需加载时间，和分配内存，适用于动态场景  
- 对每个像素的处理流程相同，可以由GPU进行并行处理
- 可以集成到现代渲染管线中   
### SSAO基本步骤   
对屏幕空间里的像素计算在三维空间的位置点 p :     

- 以 p 为球心，R为半径的球体内随机产生三维采样点  
- 估算每个采样点的AO：取得采样点在深度缓存中的投影点的AO遮蔽近似代替采样点的遮蔽  
- 投影点遮蔽的计算方法，不同的算法计算方式不同，最简单直接的是以投影点的深度值与p的深度值差异作为近似遮蔽，这样会有自身遮蔽走样问题，一种改进方法是引入法向缓存作为判断，使所有的采样点都在P点的上方，并利用采样点与投影点的深度值差异作为遮蔽近似    
- 平均所有采样点的遮蔽值    

SSAO所有计算都发生在屏幕空间，其计算效率较高，但在其精度上比不上基于顶点的AO计算结果，因此SSAO是牺牲了一定精度换取实时渲染的速度       

---